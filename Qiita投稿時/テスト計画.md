# 業務スケジュール管理システム (scheduler.osts) テスト計画

## 1. テスト計画の概要

### 1.1 目的
本テスト計画は、業務スケジュール管理システム（scheduler.osts）の動作を検証するためのテストケースを定義します。様々な条件やパターンにおいて正しく業務が抽出されるかを検証します。

### 1.2 テスト対象
- scheduler.osts（Office Script for Excel）
- 対象機能：業務一覧から対象日の業務スケジュールを自動生成する機能

### 1.3 テスト環境
- 入力データ：業務一覧テーブルテストデータ.csv
- カレンダーデータ：カレンダー.csv
- 現在の日付：2025年4月30日

## 2. テスト観点

以下の観点からテストを実施します：

1. **基本機能テスト**：各周期（日次/週次/月次/年次）、各基準（暦日/営業日）の組み合わせが正しく動作するか
2. **境界値テスト**：月初・月末・年始・年末などの境界条件が正しく処理されるか
3. **振替規則テスト**：非営業日振替規則（直前営業日/直後営業日/振替しない）が正しく適用されるか
4. **特殊日テスト**：祝日や特殊な日（2月29日など）の処理が正しく行われるか
5. **連休テスト**：ゴールデンウィークなど連続した休日がある場合の処理が正しく行われるか

## 3. テスト期間

以下の4つの期間でテストを実施します：

1. **通常期間**：2025-03-24～2025-03-30（平常時の週）
2. **月末月初期間**：2025-04-28～2025-05-04（月末から月初の切り替わり時）
3. **連休期間**：2025-05-03～2025-05-09（ゴールデンウィーク期間）
4. **年末年始期間**：2024-12-28～2025-01-04（年末から年始の切り替わり時）

## 4. テストケース詳細

### 4.1 通常期間テスト（2025-03-24～2025-03-30）

| 日付 | 曜日 | 営業日 | テスト観点 | 期待される抽出業務ID |
|------|------|--------|------------|------------------------|
| 2025-03-24 | 月 | ○ | 平日通常テスト | 1, 2, 3, 32, 94（毎日、営業日、毎週月曜、毎月第4月曜、3月第4月曜） |
| 2025-03-25 | 火 | ○ | 基本機能テスト | 1, 2, 4, 18, 28, 37, 99（毎日、営業日、毎週火曜、毎月25日、毎月最終営業日から4営業日前、毎月第4火曜、3月第4火曜） |
| 2025-03-26 | 水 | ○ | 基本機能テスト | 1, 2, 5, 27, 42, 52（毎日、営業日、毎週水曜、毎月最終営業日から3営業日前、毎月第4水曜、毎週水曜直前営業日） |
| 2025-03-27 | 木 | ○ | 基本機能テスト | 1, 2, 6, 23, 26, 53（毎日、営業日、毎週木曜、毎月末日から4日前、毎月最終営業日から2営業日前、毎週木曜直後営業日） |
| 2025-03-28 | 金 | ○ | 基本機能テスト | 1, 2, 7, 22, 25, 54, 89（毎日、営業日、毎週金曜、毎月末日から3日前、毎月最終営業日から1営業日前、毎週金曜振替なし、3月第4金曜） |
| 2025-03-29 | 土 | × | 休日テスト | 1, 8, 21（毎日、毎週土曜、毎月末日から2日前） |
| 2025-03-30 | 日 | × | 休日テスト | 1, 9, 20（毎日、毎週日曜、毎月末日から1日前） |

### 4.2 月末月初期間テスト（2025-04-28～2025-05-04）

| 日付 | 曜日 | 営業日 | テスト観点 | 期待される抽出業務ID |
|------|------|--------|------------|------------------------|
| 2025-04-28 | 月 | ○ | 月末営業日テスト | 1, 2, 3, 21, 25, 32（毎日、営業日、毎週月曜、毎月末日から2日前、毎月最終営業日から1営業日前、毎月第4月曜） |
| 2025-04-29 | 火 | × | 祝日テスト（昭和の日） | 1, 4, 20, 38（毎日、毎週火曜、毎月末日から1日前、毎月第5火曜） |
| 2025-04-30 | 水 | ○ | 月末営業日テスト | 1, 2, 5, 19, 24, 43, 52, 81（毎日、営業日、毎週水曜、毎月末日、毎月最終営業日、毎月第5水曜、毎週水曜直前営業日、4月最終営業日） |
| 2025-05-01 | 木 | ○ | 月初テスト | 1, 2, 6, 10, 47, 53, 60（毎日、営業日、毎週木曜、毎月1日、毎月第1営業日、毎週木曜直後営業日、5月1日業務） |
| 2025-05-02 | 金 | ○ | 基本機能テスト | 1, 2, 7, 11, 44, 48, 54（毎日、営業日、毎週金曜、毎月2日、毎月第1金曜、毎月第2営業日、毎週金曜振替なし） |
| 2025-05-03 | 土 | × | 祝日テスト（憲法記念日） | 1, 8, 12（毎日、毎週土曜、毎月3日） |
| 2025-05-04 | 日 | × | 祝日テスト（みどりの日） | 1, 9, 13（毎日、毎週日曜、毎月4日） |

### 4.3 連休期間テスト（2025-05-03～2025-05-09）

| 日付 | 曜日 | 営業日 | テスト観点 | 期待される抽出業務ID |
|------|------|--------|------------|------------------------|
| 2025-05-05 | 月 | × | 祝日テスト（こどもの日） | 1, 3, 14, 29（毎日、毎週月曜、毎月5日、毎月第1月曜） |
| 2025-05-06 | 火 | × | 祝日テスト（振替休日） | 1, 4, 34（毎日、毎週火曜、毎月第1火曜） |
| 2025-05-07 | 水 | ○ | 祝日後営業日テスト | 1, 2, 5, 39, 49, 52（毎日、営業日、毎週水曜、毎月第1水曜、毎月第3営業日、毎週水曜直前営業日） |
| 2025-05-08 | 木 | ○ | 基本機能テスト | 1, 2, 6, 50, 53（毎日、営業日、毎週木曜、毎月第4営業日、毎週木曜直後営業日） |
| 2025-05-09 | 金 | ○ | 基本機能テスト | 1, 2, 7, 51, 54（毎日、営業日、毎週金曜、毎月第5営業日、毎週金曜振替なし） |

### 4.4 年末年始期間テスト（2024-12-28～2025-01-04）

| 日付 | 曜日 | 営業日 | テスト観点 | 期待される抽出業務ID |
|------|------|--------|------------|------------------------|
| 2024-12-28 | 土 | × | 休日テスト | 1, 8, 22（毎日、毎週土曜、毎月末日から3日前） |
| 2024-12-29 | 日 | × | 休日テスト | 1, 9, 21（毎日、毎週日曜、毎月末日から2日前） |
| 2024-12-30 | 月 | ○ | 年末営業日テスト | 1, 2, 3, 20, 25, 33（毎日、営業日、毎週月曜、毎月末日から1日前、毎月最終営業日から1営業日前、毎月第5月曜） |
| 2024-12-31 | 火 | ○ | 年末最終日テスト | 1, 2, 4, 19, 24, 38, 52, 75, 82（毎日、営業日、毎週火曜、毎月末日、毎月最終営業日、毎月第5火曜、毎週水曜直前営業日、12月末日、12月最終営業日） |
| 2025-01-01 | 水 | × | 祝日テスト（元日） | 1, 5, 10, 39, 52, 56（毎日、毎週水曜、毎月1日、毎月第1水曜、毎週水曜直前営業日、1月1日業務） |
| 2025-01-02 | 木 | ○ | 年始営業日テスト | 1, 2, 6, 11, 47, 53, 80（毎日、営業日、毎週木曜、毎月2日、毎月第1営業日、毎週木曜直後営業日、1月第1営業日） |
| 2025-01-03 | 金 | ○ | 基本機能テスト | 1, 2, 7, 12, 44, 48, 54（毎日、営業日、毎週金曜、毎月3日、毎月第1金曜、毎月第2営業日、毎週金曜振替なし） |
| 2025-01-04 | 土 | × | 休日テスト | 1, 8, 13（毎日、毎週土曜、毎月4日） |

## 5. 振替規則テスト

特に振替規則（直前営業日/直後営業日/振替しない）の動作を検証する特別なテストケースを以下に定義します。業務ID 52, 53, 54に設定されている振替規則が正しく機能するかを確認します。

### 5.1 振替規則テストケース（2025-05-03～2025-05-08）

| 日付 | 曜日 | 営業日 | テスト対象業務ID | 振替規則 | 期待される結果 |
|------|------|--------|----------------|----------|----------------|
| 2025-05-03 | 土 | × | 52 (毎週水曜日業務) | 直前営業日 | 抽出されない |
| 2025-05-03 | 土 | × | 53 (毎週木曜日業務) | 直後営業日 | 抽出されない |
| 2025-05-03 | 土 | × | 54 (毎週金曜日業務) | 振替しない | 抽出されない |
| 2025-05-07 | 水 | ○ | 52 (毎週水曜日業務) | 直前営業日 | 業務52が抽出される |
| 2025-05-08 | 木 | ○ | 53 (毎週木曜日業務) | 直後営業日 | 業務53が抽出される |
| 2025-04-30 | 水 | ○ | 52 (毎週水曜日業務) | 直前営業日 | 業務52が抽出される |
| 2025-05-02 | 金 | ○ | 54 (毎週金曜日業務) | 振替しない | 業務54が抽出される |

## 6. 閾値テスト

特に境界値や特殊ケースのテストを実施します。

### 6.1 閾値テストケース

| 日付 | 曜日 | 営業日 | テスト観点 | 期待される抽出業務ID |
|------|------|--------|------------|------------------------|
| 2024-02-29 | 木 | ○ | 閏年テスト | 1, 2, 6, 19, 24, 53, 76（毎日、営業日、毎週木曜、毎月末日業務、毎月最終営業日業務、毎週木曜直後営業日、2月29日業務） |
| 2025-01-31 | 金 | ○ | 月末テスト（31日） | 1, 2, 7, 19, 24, 46, 54（毎日、営業日、毎週金曜、毎月末日業務、毎月最終営業日業務、毎月第5金曜、毎週金曜振替なし） |
| 2025-02-28 | 金 | ○ | 月末テスト（28日） | 1, 2, 7, 19, 24, 54（毎日、営業日、毎週金曜、毎月末日業務、毎月最終営業日業務、毎週金曜振替なし） |
| 2025-03-31 | 月 | ○ | 第5週テスト | 1, 2, 3, 19, 24, 33, 72, 83, 95（毎日、営業日、毎週月曜、毎月末日業務、毎月最終営業日業務、毎月第5月曜業務、3月最終営業日業務、3月最終営業日業務、3月第5月曜業務） |

## 7. テスト実施手順

1. scheduler.ostsを開く
2. 入力シートのB1セルに各テスト日付を設定する
3. スクリプトを実行する
4. 出力された業務スケジュールと期待される結果を比較する
5. 特に以下の点を重点的に確認する：
   - 該当日の全ての業務が抽出されていること
   - 非営業日の振替規則が正しく適用されていること
   - 期待されない業務が誤って抽出されていないこと

## 8. 特記事項

1. 「業務一覧テーブルテストデータ.csv」にはID=52,53,54のデータに非営業日振替規則（直前営業日、直後営業日、振替しない）が設定されており、これらの動作確認が特に重要
2. 連休期間（ゴールデンウィーク）の振る舞いとして、5/3～5/6の休日とその前後の営業日での業務抽出が正しく行われるかの確認が重要
3. 月末最終営業日や月初第1営業日などの境界条件での動作確認
4. 閏年（2月29日）における特殊業務の抽出確認

## 9. テスト結果記録

| テスト日 | 実施日 | テスト内容 | 結果 | 備考 |
|---------|--------|------------|------|------|
| 2025-03-24 | | 通常期間テスト | | |
| 2025-03-25 | | 通常期間テスト | | |
| ... | | | | |
| 2025-05-09 | | 連休期間テスト | | |